{"ast":null,"code":"export default {\n  data() {\n    return {\n      tableData: this.$global_msg.save\n    };\n  },\n  methods: {\n    cancelLike() {\n      let currentSelect = this.$refs.accountTable.selection;\n      var url = 'http://localhost:8081/runyun/cancelLikes/' + this.$global_msg.userId;\n      this.axios.post(url, currentSelect).then(resp => {\n        let data = resp.data;\n        if (data.code == 200) {\n          this.$global_msg.save = data.data;\n          this.tableData = data.data;\n        }\n      });\n    },\n    downFile() {\n      let currentSelect = this.$refs.accountTable.selection;\n      if (currentSelect.length != 1) {\n        alert(\"请选择一个文件进行下载\");\n      } else {\n        var url = 'http://localhost:8081/runyun/download/' + currentSelect[0].shareUser;\n        var filename = currentSelect[0].fileName.substring(currentSelect[0].fileName.lastIndexOf('\\\\') + 1);\n        this.axios.get(url, {\n          params: {\n            path: currentSelect[0].fileName\n          },\n          responseType: 'blob'\n        }).then(res => {\n          console.log('文件下载成功');\n          const blob = new Blob([res.data]);\n          const fileName = filename;\n\n          //对于<a>标签，只有 Firefox 和 Chrome（内核） 支持 download 属性\n          //IE10以上支持blob，但是依然不支持download\n          if ('download' in document.createElement('a')) {\n            //支持a标签download的浏览器\n            const link = document.createElement('a'); //创建a标签\n            link.download = fileName; //a标签添加属性\n            link.style.display = 'none';\n            link.href = URL.createObjectURL(blob);\n            document.body.appendChild(link);\n            link.click(); //执行下载\n            URL.revokeObjectURL(link.href); //释放url\n            document.body.removeChild(link); //释放标签\n          } else {\n            navigator.msSaveBlob(blob, fileName);\n          }\n        }).catch(res => {\n          console.log('文件下载失败');\n        });\n      }\n    }\n  }\n};","map":{"version":3,"mappings":"AAuCA;EACAA;IACA;MACAC;IACA;EACA;EACAC;IACAC;MACA;MAEA;MACA;QACA;QACA;UACA;UACA;QACA;MACA;IACA;IAEAC;MACA;MAEA;QACAC;MACA;QACA;QACA;QACA,oBACA;UACAC;YACAC;UACA;UACAC;QACA,EACA;UACAC;UACA;UACA;;UAEA;UACA;UACA;YACA;YACA;YACAC;YACAA;YACAA;YACAC;YACAD;YACAE;YACAD;UACA;YACAE;UACA;QACA;UACAJ;QACA;MAEA;IAGA;EAIA;AACA","names":["data","tableData","methods","cancelLike","downFile","alert","params","path","responseType","console","link","document","URL","navigator"],"sourceRoot":"src/views/Mycollect","sources":["Mycollect.vue"],"sourcesContent":["<template>\r\n    <div>\r\n      <div class=\"header\">\r\n        <span class=\"title\">我的收藏</span>\r\n      </div>\r\n      <div class=\"middle\">\r\n        <el-button class=\"canclebtn\" type=\"primary\" icon=\"el-icon-delete\"\r\n          @click=\"cancelLike\">取消收藏</el-button\r\n        >\r\n        <el-button class=\"downloadbtn\" type=\"primary\" icon=\"el-icon-download\"\r\n          @click=\"downFile\">下载</el-button\r\n        >\r\n      </div>\r\n      <div class=\"line\"></div>\r\n      <div class=\"body\">\r\n        <el-table\r\n          :data=\"tableData\"\r\n          height=\"550\"\r\n          stripe\r\n          border\r\n          style=\"width: 100%\"\r\n          ref=\"accountTable\"\r\n        >\r\n          <el-table-column type=\"selection\" width=\"180\"> </el-table-column>\r\n          <el-table-column prop=\"fileName\" label=\"文件名\" width=\"250\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"filePath\" label=\"文件目录\" width=\"250\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"fileSize\" label=\"文件大小(B)\" width=\"250\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"saveTime\" label=\"收藏日期\" width=\"250\">\r\n          </el-table-column>\r\n          <el-table-column prop=\"shareUser\" label=\"文件上传者\"> </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </div>\r\n  </template>\r\n    \r\n    <script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        tableData: this.$global_msg.save\r\n      };\r\n    },\r\n    methods: {\r\n      cancelLike() {\r\n        let currentSelect = this.$refs.accountTable.selection;\r\n        \r\n        var url = 'http://localhost:8081/runyun/cancelLikes/'+this.$global_msg.userId;\r\n        this.axios.post(url, currentSelect).then((resp)=>{\r\n              let data = resp.data;\r\n              if (data.code == 200) {\r\n                this.$global_msg.save = data.data;\r\n                this.tableData = data.data;\r\n              }\r\n          })\r\n      },\r\n\r\n      downFile() {\r\n        let currentSelect = this.$refs.accountTable.selection;\r\n\r\n        if (currentSelect.length != 1) {\r\n            alert(\"请选择一个文件进行下载\");\r\n        } else {\r\n          var url = 'http://localhost:8081/runyun/download/' + currentSelect[0].shareUser;\r\n          var filename = currentSelect[0].fileName.substring(currentSelect[0].fileName.lastIndexOf('\\\\')+1);\r\n          this.axios.get( url ,\r\n          {\r\n              params:{\r\n                  path: currentSelect[0].fileName\r\n              },\r\n              responseType: 'blob'\r\n          }\r\n                ).then((res)=>{\r\n                    console.log('文件下载成功');\r\n                    const blob = new Blob([res.data]);\r\n                    const fileName = filename;\r\n\r\n                    //对于<a>标签，只有 Firefox 和 Chrome（内核） 支持 download 属性\r\n                    //IE10以上支持blob，但是依然不支持download\r\n                    if ('download' in document.createElement('a')) {\r\n                        //支持a标签download的浏览器\r\n                        const link = document.createElement('a');//创建a标签\r\n                        link.download = fileName;//a标签添加属性\r\n                        link.style.display = 'none';\r\n                        link.href = URL.createObjectURL(blob);\r\n                        document.body.appendChild(link);\r\n                        link.click();//执行下载\r\n                        URL.revokeObjectURL(link.href); //释放url\r\n                        document.body.removeChild(link);//释放标签\r\n                    } else {\r\n                        navigator.msSaveBlob(blob, fileName);\r\n                    }\r\n                }).catch((res)=>{\r\n                    console.log('文件下载失败');\r\n                });\r\n\r\n        }\r\n        \r\n            \r\n      },\r\n\r\n\r\n\r\n    },\r\n  };\r\n  </script>\r\n    \r\n    <style lang=\"less\" scoped>\r\n  .header {\r\n    background-color: #dcdfe6;\r\n    height: 60px;\r\n    line-height: 60px;\r\n    display: flex;\r\n  }\r\n  .title {\r\n    color: #409eff;\r\n    float: left;\r\n    font-size: 30px;\r\n    margin-left: 20px;\r\n  }\r\n  .middle {\r\n    height: 50px;\r\n    line-height: 50px;\r\n    display: flex;\r\n  }\r\n  .canclebtn{\r\n    display: flex;\r\n    //margin-left: 170px;\r\n    height: 80%;\r\n    margin-top: 5px;\r\n    margin-left: 10px;\r\n  }\r\n.downloadbtn {\r\n    display: flex;\r\n    margin-left: 10px;\r\n    height: 80%;\r\n    margin-top: 5px;\r\n  }\r\n  .line {\r\n    height: 0;\r\n    width: 100%;\r\n    border: 1px solid #dcdfe6;\r\n  }\r\n  .body {\r\n     // margin-left: 170px;\r\n      margin: 20px 10px;\r\n  }\r\n  </style>"]},"metadata":{},"sourceType":"module"}