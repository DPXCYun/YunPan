{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      show: false,\n      tableData: this.$global_msg.disk,\n      pathArr: [],\n      imgUrl: \"\",\n      dialogVisible: false,\n      fileUrl: '',\n      // üëá Êñ∞Â¢ûÔºö‰∏ä‰º†Áä∂ÊÄÅÂíåËøõÂ∫¶\n      uploading: false,\n      uploadProgress: 0\n    };\n  },\n  computed: {\n    //ÁªèËøáÊãºÊé•ÁöÑÈù¢ÂåÖÂ±ëÁõÆÂΩï\n    pathString: function () {\n      var pstr = \"/\";\n      if (this.pathArr.length === 0) {\n        return pstr;\n      }\n      for (var i = 0; i < this.pathArr.length; i++) {\n        var tempStr = this.pathArr[i] + \"/\";\n        pstr += tempStr;\n      }\n      return pstr;\n    }\n  },\n  _methods: {\n    copy() {\n      const textarea = document.getElementById('textarea');\n      navigator.clipboard.writeText(textarea.value).then(() => this.$alert(\"Â§çÂà∂ÊàêÂäüÔºÅ\")).catch(err => console.error('Â§çÂà∂Â§±Ë¥•', err));\n    },\n    // copy(){\n    //   var content = document.getElementById('textarea').innerHTML;\n    //\n    //   navigator.clipboard.writeText(content)\n    //   .then(() => {\n    //     this.$alert(\"Â§çÂà∂ÊàêÂäüÔºÅ\")\n    //   })\n    //   .catch(err => {\n    //   console.log('Something went wrong', err);\n    //   })\n    // },\n\n    //ËøîÂõû‰∏äÁ∫ßÁõÆÂΩï\n    returnToLastDir() {\n      this.updateFolderSize();\n      if (this.pathArr.length === 0) {\n        this.$message.info(\"Â∑≤ÁªèÂà∞ËææÊ†πÁõÆÂΩï\");\n        return;\n      }\n      this.pathArr.pop();\n      //todo:Êõ¥Êñ∞ÂÜÖÂÆπ\n      var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\n      this.axios({\n        method: 'GET',\n        url: url\n      }).then(resp => {\n        let data = resp.data;\n        console.log(data);\n        if (data.success) {\n          this.tableData = data.data.fileList;\n        }\n      });\n    },\n    //ÁÇπÂÖ•Êñá‰ª∂Â§π\n    enterNextDir(row) {\n      this.updateFolderSize();\n      console.log(row);\n      var tempStr = row.fileName;\n      this.pathArr.push(tempStr);\n      //todoÔºöÊõ¥Êñ∞ÂÜÖÂÆπ\n      var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\n      this.axios({\n        method: 'GET',\n        url: url\n      }).then(resp => {\n        let data = resp.data;\n        console.log(data);\n        if (data.success) {\n          this.tableData = data.data.fileList;\n        }\n      });\n    },\n    //Êñá‰ª∂ÂàÜ‰∫´\n    shareFile(row) {\n      if (row.isfolder === 1) {\n        this.$message.warning(\"ÊöÇÊó∂‰∏çÊîØÊåÅÂàÜ‰∫´Êñá‰ª∂Â§πÂÜÖÂÆπ\");\n        return;\n      }\n      var that = this;\n      //ËØ∑Ê±ÇtokenÔºåÁî±‰∫éÂºÇÊ≠•ÁöÑÂÖ≥Á≥ªÔºåÂú®ÂºπÁ™óÂºπÂá∫Êù•‰πãÂâçË¶ÅÊîπÂÆåÊï∞ÊçÆÔºåÊâÄÊúâËøôÊÆµÊîæÂâçÈù¢ÔºåÊî∂ÂõæÁâáËÇØÂÆöÊØîÊî∂Â≠óÁ¨¶‰∏≤ÊÖ¢\n\n      // this.$loading(\"loading\");//ÊòæÁ§∫Ê≠£Âú®Âä†ËΩΩ\n      //Êé•‰∏ãÊù•ÁöÑÈÄªËæë‰∏∫ÔºåÂèëËµ∑ËØ∑Ê±ÇÔºåÊàêÂäüÂä†ËΩΩ/Âä†ËΩΩÂ§±Ë¥•\n      console.log(sessionStorage.getItem(\"saToken\"));\n      var url = \"http://localhost:8989/fileShare/createQRCode1?fileId=\" + row.id;\n      this.$axios({\n        url: url,\n        method: \"GET\",\n        headers: {\n          'satoken': sessionStorage.getItem(\"saToken\")\n        },\n        responseType: \"blob\"\n      }).then(function (res) {\n        console.log(\"ËØ∑Ê±ÇÂèëËµ∑ÊàêÂäü\");\n        console.log(res);\n        var typeArray = res.data;\n        var blob = new Blob([typeArray], {\n          type: res.headers['Content-Type']\n        });\n        var url = window.URL.createObjectURL(blob);\n        while (1) {\n          console.log(\"ËøòÊú™Ëé∑Âæóurl\");\n          if (url != '') {\n            console.log(\"Ëé∑Âæóurl‰∫Ü\");\n            console.log(url);\n            that.imgUrl = url;\n            that.$axios({\n              url: \"http://localhost:8989/getShareCode?fileId=\" + row.id,\n              method: \"GET\",\n              headers: {\n                'satoken': sessionStorage.getItem(\"saToken\")\n              }\n            }).then(res => {\n              console.log(res);\n              var token = res.data.data[\"access_token\"];\n              that.fileUrl = \"http://localhost:8989/publicDownload?access_token=\" + token;\n              that.dialogVisible = true;\n            });\n            break;\n          }\n        }\n        // var imgHtmlString = \"<image src='\" + url + \"'>\";\n        //ÂºπÁ™ó\n        // that.$alert('<strong>ÊÇ®ÁöÑÂàÜ‰∫´‰∫åÁª¥Á†ÅÔºö</strong>' +\n        //     \"<image width='390' height='200' src='\" + url + \"'>\" +\n        //     '<strong>ÊÇ®ÁöÑÊñá‰ª∂‰∏ãËΩΩÂú∞ÂùÄÔºö</strong>', 'ÂàÜ‰∫´ËØ¶ÊÉÖ', {\n        //   dangerouslyUseHTMLString: true\n        // });\n      });\n    },\n\n    // Êñá‰ª∂Â§πÊàñÊñá‰ª∂ÈáçÂëΩÂêç\n    handleEdit_(row) {\n      this.$prompt('‰øÆÊîπÊñá‰ª∂Âêç', 'ÊèêÁ§∫', {\n        confirmButtonText: 'Á°ÆÂÆö',\n        cancelButtonText: 'ÂèñÊ∂à'\n      }).then(({\n        value\n      }) => {\n        if (value == null) {\n          this.$message({\n            type: 'info',\n            message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\n          });\n          return;\n        }\n        this.axios({\n          method: 'PUT',\n          url: 'http://localhost:8989/rename',\n          data: {\n            folderId: row.id,\n            newFolderName: value\n          }\n        }).then(resp => {\n          let data = resp.data;\n          if (data.success) {\n            this.getFileAndFolder();\n            this.$message({\n              type: 'success',\n              message: data.message\n            });\n          } else {\n            this.$message({\n              type: 'info',\n              message: data.message\n            });\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: 'ÂèñÊ∂àËæìÂÖ•'\n        });\n      });\n    },\n    //ÁßªÂä®Êñá‰ª∂Â§πÊàñÊñá‰ª∂\n    moveFile(row) {\n      console.log(row);\n      this.$prompt('ËæìÂÖ•Ë¶ÅÁßªÂä®ÁöÑË∑ØÂæÑÔºåÊ†ºÂºè: /**/**/', 'ÁßªÂä®Âà∞', {\n        confirmButtonText: 'Á°ÆÂÆö',\n        cancelButtonText: 'ÂèñÊ∂à'\n      }).then(({\n        value\n      }) => {\n        if (value == null) {\n          this.$message({\n            type: 'info',\n            message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\n          });\n          return;\n        }\n        if (this.pathString == value) {\n          this.$message({\n            type: 'info',\n            message: \"Â∑≤Âú®ÂΩìÂâçÊñá‰ª∂Â§π\"\n          });\n          return;\n        }\n        this.axios({\n          method: 'PUT',\n          url: 'http://localhost:8989/move',\n          data: {\n            folderId: row.id,\n            newPath: value\n          }\n        }).then(resp => {\n          let data = resp.data;\n          if (data.success) {\n            this.getFileAndFolder();\n            this.$message({\n              type: 'success',\n              message: data.message\n            });\n          } else {\n            this.$message({\n              type: 'info',\n              message: data.message\n            });\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: 'ÂèñÊ∂àËæìÂÖ•'\n        });\n      });\n    },\n    updateFolderSize() {\n      this.axios({\n        method: 'GET',\n        url: 'http://localhost:8989/getFolderSize?path=' + this.pathString\n      });\n    },\n    // Ëé∑ÂèñË∑ØÂæÑ‰∏ãÊñá‰ª∂ÂíåÊñá‰ª∂Â§π\n    getFileAndFolder() {\n      var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\n      this.axios({\n        method: 'GET',\n        url: url\n      }).then(resp => {\n        let data = resp.data;\n        console.log(data);\n        if (data.success) {\n          this.tableData = data.data.fileList;\n        }\n      });\n    },\n    // ÂàõÂª∫Êñá‰ª∂Â§π\n    createDir() {\n      this.$prompt('ËæìÂÖ•Êñá‰ª∂Â§πÁõÆÂΩï', 'ÊèêÁ§∫', {\n        confirmButtonText: 'Á°ÆÂÆö',\n        cancelButtonText: 'ÂèñÊ∂à'\n      }).then(({\n        value\n      }) => {\n        if (value == null) {\n          this.$message({\n            type: 'info',\n            message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\n          });\n          return;\n        }\n        this.axios({\n          method: 'POST',\n          url: 'http://localhost:8989/createFolder',\n          data: {\n            path: this.pathString,\n            folderName: value\n          }\n        }).then(resp => {\n          let data = resp.data;\n          if (data.success) {\n            this.getFileAndFolder();\n            this.$message({\n              type: 'success',\n              message: data.message\n            });\n          } else {\n            this.$message({\n              type: 'info',\n              message: data.message\n            });\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: 'ÂèñÊ∂àËæìÂÖ•'\n        });\n      });\n    },\n    // Âà†Èô§Êñá‰ª∂Â§πÊàñÊñá‰ª∂\n    deleteFile_(row, index) {\n      if (confirm(\"ÊòØÂê¶Âà†Èô§ÔºÅ\")) {\n        this.axios({\n          method: 'DELETE',\n          url: 'http://localhost:8989/delete',\n          data: {\n            fileId: row.id\n          }\n        }).then(resp => {\n          let data = resp.data;\n          if (data.success) {\n            this.tableData.splice(index, 1);\n            this.$message({\n              type: 'success',\n              message: data.message\n            });\n          } else {\n            this.$message({\n              type: 'info',\n              message: data.message\n            });\n          }\n        });\n      } else {\n        this.$message({\n          type: 'info',\n          message: 'ÂèñÊ∂àÂà†Èô§'\n        });\n      }\n    },\n    getFile(event) {\n      this.file = event.target.files[0];\n      console.log(this.file);\n    },\n    submitForm(event) {\n      event.preventDefault();\n      let formData = new FormData();\n      formData.append('ifile', this.file);\n      formData.append(\"path\", this.pathString);\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n          \"satoken\": sessionStorage.getItem(\"satoken\")\n        },\n        // üëá ÂÖ≥ÈîÆÔºöÁõëÂê¨‰∏ä‰º†ËøõÂ∫¶\n        onUploadProgress: progressEvent => {\n          if (progressEvent.total > 0) {\n            this.uploadProgress = Math.round(progressEvent.loaded / progressEvent.total * 100);\n          }\n        }\n      };\n      console.log(config);\n      var url = \"http://localhost:8989/upload\";\n      this.$http.post(url, formData, config).then(res => {\n        console.log(res);\n        let data = res.data;\n        if (data.code !== 10000) {\n          this.$message.error(data.message);\n        } else {\n          this.getFileAndFolder();\n          this.$message({\n            message: \"‰∏ä‰º†ÊàêÂäü\",\n            type: \"success\"\n          });\n        }\n      });\n    },\n    download(row) {\n      let that = this;\n      console.log(row);\n      let headers = {\n        'Content-Type': 'multipart/form-data',\n        \"satoken\": sessionStorage.getItem(\"satoken\")\n      };\n      var fileId = row.id;\n      var filename = row.fileName;\n      // let url=\"http://localhost:8989/download?fileId=\"+fileId\n      // window.open(url, \"_blank\")\n      this.axios({\n        url: \"http://localhost:8989/download\",\n        method: \"GET\",\n        headers: headers,\n        params: {\n          fileId: fileId\n        }\n      }).then(res => {\n        console.log(res);\n        that.$message({\n          message: \"ËØ∑Ê±ÇÊàêÂäü\",\n          type: \"success\"\n        });\n        let blob = new Blob([res.data]);\n        let downloadElement = document.createElement(\"a\");\n        let href = window.URL.createObjectURL(blob); //ÂàõÂª∫‰∏ãËΩΩÁöÑÈìæÊé•\n        downloadElement.href = href;\n        downloadElement.download = filename; //‰∏ãËΩΩÂêéÊñá‰ª∂Âêç\n        document.body.appendChild(downloadElement);\n        downloadElement.click(); //ÁÇπÂáª‰∏ãËΩΩ\n        document.body.removeChild(downloadElement); //‰∏ãËΩΩÂÆåÊàêÁßªÈô§ÂÖÉÁ¥†\n        window.URL.revokeObjectURL(href); //ÈáäÊîæÊéâblobÂØπË±°\n      }).catch(function (error) {\n        if (error.response.status == 400) {\n          that.$message({\n            message: \"Êñá‰ª∂‰∏çÂ≠òÂú®\",\n            type: \"error\"\n          });\n        } else if (error.response.status == 500) {\n          that.$message({\n            message: \"Êä±Ê≠âÔºåÊñá‰ª∂Â∑≤‰∏¢Â§±\",\n            type: \"error\"\n          });\n        }\n      });\n    }\n  },\n  get methods() {\n    return this._methods;\n  },\n  set methods(value) {\n    this._methods = value;\n  }\n};","map":{"version":3,"mappings":";AAwEA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;MACA;QACA;MACA;MACA;QACA;QACAC;MACA;MACA;IACA;EACA;EAEAC;IACAC;MACA;MACAC,8CACAC,iCACAC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACAC;MACA;MACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;QACAC;QACAC;MACA;QACA;QACAC;QACA;UACA;QACA;MACA;IACA;IAEA;IACAC;MACA;MACAD;MACA;MACA;MACA;MACA;MACA;QACAF;QACAC;MACA;QACA;QACAC;QACA;UACA;QACA;MACA;IACA;IAEA;IACAE;MAEA;QACA;QACA;MACA;MACA;MACA;;MAEA;MACA;MACAF;MACA;MACA;QACAD;QACAD;QACAK;UACA;QACA;QACAC;MACA;QACAJ;QACAA;QACA;QACA;UAAAK;QAAA;QACA;QACA;UACAL;UACA;YACAA;YACAA;YACAM;YACAA;cACAP;cACAD;cACAK;gBACA;cACA;YACA;cACAH;cACA;cACAM;cACAA;YACA;YACA;UACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MAEA;IAEA;;IAEA;IACAC;MACA;QACAC;QACAC;MACA;QAAAC;MAAA;QACA;UACA;YACAL;YACAM;UACA;UACA;QACA;QACA;UACAb;UACAC;UACAnB;YACAgC;YACAC;UACA;QACA;UACA;UACA;YACA;YACA;cACAR;cACAM;YACA;UACA;YACA;cACAN;cACAM;YACA;UACA;QACA;MACA;QACA;UACAN;UACAM;QACA;MACA;IACA;IAGA;IACAG;MACAd;MACA;QACAQ;QACAC;MACA;QAAAC;MAAA;QACA;UACA;YACAL;YACAM;UACA;UACA;QACA;QACA;UACA;YACAN;YACAM;UACA;UACA;QACA;QACA;UACAb;UACAC;UACAnB;YACAgC;YACAG;UACA;QACA;UACA;UACA;YACA;YACA;cACAV;cACAM;YACA;UACA;YACA;cACAN;cACAM;YACA;UACA;QACA;MACA;QACA;UACAN;UACAM;QACA;MACA;IACA;IAEAK;MACA;QACAlB;QACAC;MACA;IACA;IAEA;IACAkB;MACA;MACA;QACAnB;QACAC;MACA;QACA;QACAC;QACA;UACA;QACA;MACA;IACA;IAEA;IACAkB;MACA;QACAV;QACAC;MACA;QAAAC;MAAA;QACA;UACA;YACAL;YACAM;UACA;UACA;QACA;QACA;UACAb;UACAC;UACAnB;YACAuC;YACAC;UACA;QACA;UACA;UACA;YACA;YACA;cACAf;cACAM;YACA;UACA;YACA;cACAN;cACAM;YACA;UACA;QACA;MACA;QACA;UACAN;UACAM;QACA;MACA;IACA;IAEA;IACAU;MACA;QACA;UACAvB;UACAC;UACAnB;YACA0C;UACA;QACA;UACA;UACA;YACA;YACA;cACAjB;cACAM;YACA;UACA;YACA;cACAN;cACAM;YACA;UACA;QACA;MACA;QACA;UACAN;UACAM;QACA;MACA;IACA;IAGAY;MACA;MACAvB;IACA;IAEAwB;MACAC;MACA;MACAC;MACAA;MAEA;QACAvB;UACA;UACA;QACA;QACA;QACAwB;UACA;YACA;UACA;QACA;MACA;MACA3B;MACA;MACA;QACAA;QACA;QACA;UACA;QACA;UACA;UACA;YACAW;YACAN;UACA;QACA;MACA;IACA;IAEAuB;MACA;MACA5B;MACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAD;QACAD;QACAK;QACA0B;UACAP;QACA;MACA;QACAtB;QACAM;UACAK;UACAN;QACA;QACA;QACA;QACA;QACAyB;QACAA;QACAC;QACAD;QACAC;QACAC;MACA;QACA;UACA1B;YACAK;YACAN;UACA;QACA,OACA;UACAC;YACAK;YACAN;UACA;QACA;MACA;IAEA;EACA;EAEA;IACA;EACA;EACA;IACA;EACA;AACA","names":["data","show","tableData","pathArr","imgUrl","dialogVisible","fileUrl","uploading","uploadProgress","computed","pathString","pstr","_methods","copy","navigator","then","catch","returnToLastDir","method","url","console","enterNextDir","shareFile","headers","responseType","type","that","handleEdit_","confirmButtonText","cancelButtonText","value","message","folderId","newFolderName","moveFile","newPath","updateFolderSize","getFileAndFolder","createDir","path","folderName","deleteFile_","fileId","getFile","submitForm","event","formData","onUploadProgress","download","params","downloadElement","document","window"],"sourceRoot":"src/views/Mydisk","sources":["Mydisk.vue"],"sourcesContent":["<template>\r\n    <div class=\"mydisk\">\r\n        <el-dialog\r\n          title=\"ÂàÜ‰∫´ËØ¶ÊÉÖ\"\r\n          :visible.sync=\"dialogVisible\"\r\n          width=\"30%\">\r\n          <strong>ÊÇ®ÁöÑÂàÜ‰∫´‰∫åÁª¥Á†ÅÔºö</strong>\r\n<!--          <image width='390' height='200' :src=\"imgUrl\"/>-->\r\n<!--          <image src=\"F://wallhaven/bg.jpg\"></image>-->\r\n          <img :src=\"imgUrl\" class=\"dialogImg\">\r\n\r\n          <strong><br>ÊÇ®ÁöÑÊñá‰ª∂‰∏ãËΩΩÂú∞ÂùÄÔºö</strong>\r\n          <textarea id=\"textarea\" cols=\"25\" rows=\"1\" v-model=\"fileUrl\"></textarea>\r\n          <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button @click=\"copy\">Â§çÂà∂</el-button>\r\n            <el-button type=\"primary\" @click=\"dialogVisible = false\">Á°Æ ÂÆö</el-button>\r\n          </span>\r\n        </el-dialog>\r\n        <!-- ÊåâÈíÆÂå∫Âüü -->\r\n<!--        <el-image :src=\"imgUrl\"></el-image>-->\r\n        <div class=\"header\">\r\n            <!-- <el-button type=\"danger\" >‰∏ä‰º†Êñá‰ª∂</el-button> -->\r\n            <form style=\"heigth: 40px\">\r\n                <input type=\"file\" class=\"input1_\" @change=\"getFile($event)\">\r\n                <button class=\"btn1_\" @click=\"submitForm($event)\">Êèê‰∫§</button>\r\n\r\n              <!-- üëá Êñ∞Â¢ûÔºöËøõÂ∫¶Êù° -->\r\n              <el-progress\r\n                  v-if=\"uploading\"\r\n                  :percentage=\"uploadProgress\"\r\n                  style=\"width: 300px; margin-left: 10px;\"\r\n                  :stroke-width=\"10\"\r\n                  :show-text=\"true\">\r\n              </el-progress>\r\n            </form>\r\n\r\n            <el-button type=\"primary\" @click=\"createDir\" style=\"margin-left: 30px\">ÂàõÂª∫Êñá‰ª∂Â§π</el-button>\r\n<!--            <el-button type=\"info\" @click=\"deleteFile\">Âà†Èô§</el-button>-->\r\n<!--            <el-button type=\"primary\" @click=\"shareFiles\">ÂàÜ‰∫´</el-button>-->\r\n            <el-button type=\"primary\" @click=\"returnToLastDir()\">ËøîÂõû‰∏äÁ∫ß</el-button>\r\n<!--            <el-button type=\"primary\"></el-button>-->\r\n        </div>\r\n<!--        Â±ïÁé∞Èù¢ÂåÖÂ±ë-->\r\n        <div class=\"bread\">\r\n          ÂΩìÂâçË∑ØÂæÑÔºö{{pathString}}\r\n        </div>\r\n      <!-- Ë°®Ê†ºÂå∫ÂüüÂ±ïÁ§∫ËßÜÂõæÊï∞ÊçÆ -->\r\n        <div class=\"wrapper\">\r\n            <el-table :data=\"tableData\" border ref=\"accountTable\" style=\"width:100%\">\r\n<!--                <el-table-column type=\"\" width=\"100\"> </el-table-column>-->\r\n                <el-table-column v-if=\"show\" prop=\"id\" label=\"id\" width=\"200\" style=\"padding: 0\"></el-table-column>\r\n              <el-table-column prop=\"fileImg\" label=\"\" width=\"50\"></el-table-column>\r\n                <el-table-column prop=\"fileName\" label=\"Êñá‰ª∂Âêç\" width=\"200\"></el-table-column>\r\n                <el-table-column prop=\"fileSize\" label=\"Â§ßÂ∞è(KB)\" width=\"200\"></el-table-column>\r\n                <el-table-column prop=\"uploadTime\" label=\"‰∏ä‰º†Êó∂Èó¥\" width=\"200\"> </el-table-column>\r\n                <el-table-column label=\"Êìç‰Ωú\" width=\"500\">\r\n                  <template slot-scope=\"scope\">\r\n                    <el-button size=\"mini\" v-if=\"scope.row.isfolder===1\" @click=\"enterNextDir(scope.row)\">ËøõÂÖ•</el-button>\r\n                    <el-button size=\"mini\" v-if=\"scope.row.isfolder===0\" @click=\"download(scope.row)\">‰∏ãËΩΩ</el-button>\r\n                    <el-button size=\"mini\" @click=\"shareFile(scope.row)\">ÂàÜ‰∫´</el-button>\r\n                    <el-button size=\"mini\" @click=\"handleEdit_(scope.row)\">ÈáçÂëΩÂêç</el-button>\r\n                    <el-button size=\"mini\" @click=\"moveFile(scope.row)\">ÁßªÂä®</el-button>\r\n                    <el-button size=\"mini\" type=\"danger\" @click=\"deleteFile_(scope.row, scope.$index)\">Âà†Èô§</el-button>\r\n                  </template>\r\n                </el-table-column>\r\n            </el-table>\r\n        </div>\r\n        <!-- ÂàÜÈ°µ -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n      data() {\r\n        return {\r\n          show: false,\r\n          tableData: this.$global_msg.disk,\r\n          pathArr: [],\r\n          imgUrl: \"\",\r\n          dialogVisible: false,\r\n          fileUrl: '',\r\n\r\n          // üëá Êñ∞Â¢ûÔºö‰∏ä‰º†Áä∂ÊÄÅÂíåËøõÂ∫¶\r\n          uploading: false,\r\n          uploadProgress: 0,\r\n        };\r\n      },\r\n        computed:{\r\n          //ÁªèËøáÊãºÊé•ÁöÑÈù¢ÂåÖÂ±ëÁõÆÂΩï\r\n          pathString:function (){\r\n            var pstr = \"/\";\r\n            if(this.pathArr.length===0){\r\n              return pstr;\r\n            }\r\n            for(var i = 0;i<this.pathArr.length;i++){\r\n              var tempStr = this.pathArr[i] + \"/\";\r\n              pstr += tempStr;\r\n            }\r\n            return pstr;\r\n          }\r\n        },\r\n\r\n      _methods: {\r\n        copy() {\r\n          const textarea = document.getElementById('textarea');\r\n          navigator.clipboard.writeText(textarea.value)\r\n              .then(() => this.$alert(\"Â§çÂà∂ÊàêÂäüÔºÅ\"))\r\n              .catch(err => console.error('Â§çÂà∂Â§±Ë¥•', err));\r\n        },\r\n        // copy(){\r\n        //   var content = document.getElementById('textarea').innerHTML;\r\n        //\r\n        //   navigator.clipboard.writeText(content)\r\n        //   .then(() => {\r\n        //     this.$alert(\"Â§çÂà∂ÊàêÂäüÔºÅ\")\r\n        //   })\r\n        //   .catch(err => {\r\n        //   console.log('Something went wrong', err);\r\n        //   })\r\n        // },\r\n\r\n        //ËøîÂõû‰∏äÁ∫ßÁõÆÂΩï\r\n        returnToLastDir(){\r\n          this.updateFolderSize()\r\n          if(this.pathArr.length===0){\r\n            this.$message.info(\"Â∑≤ÁªèÂà∞ËææÊ†πÁõÆÂΩï\")\r\n            return;\r\n          }\r\n          this.pathArr.pop();\r\n          //todo:Êõ¥Êñ∞ÂÜÖÂÆπ\r\n          var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\r\n          this.axios({\r\n            method:'GET',\r\n            url: url,\r\n          }).then((resp)=>{\r\n            let data = resp.data;\r\n            console.log(data)\r\n            if (data.success) {\r\n              this.tableData = data.data.fileList;\r\n            }\r\n          })\r\n        },\r\n\r\n        //ÁÇπÂÖ•Êñá‰ª∂Â§π\r\n        enterNextDir(row){\r\n          this.updateFolderSize()\r\n          console.log(row);\r\n          var tempStr = row.fileName;\r\n          this.pathArr.push(tempStr);\r\n          //todoÔºöÊõ¥Êñ∞ÂÜÖÂÆπ\r\n          var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\r\n          this.axios({\r\n            method:'GET',\r\n            url: url,\r\n          }).then((resp)=>{\r\n            let data = resp.data;\r\n            console.log(data)\r\n            if (data.success) {\r\n              this.tableData = data.data.fileList;\r\n            }\r\n          })\r\n        },\r\n\r\n        //Êñá‰ª∂ÂàÜ‰∫´\r\n        shareFile(row){\r\n\r\n          if(row.isfolder===1){\r\n            this.$message.warning(\"ÊöÇÊó∂‰∏çÊîØÊåÅÂàÜ‰∫´Êñá‰ª∂Â§πÂÜÖÂÆπ\")\r\n            return;\r\n          }\r\n          var that = this;\r\n          //ËØ∑Ê±ÇtokenÔºåÁî±‰∫éÂºÇÊ≠•ÁöÑÂÖ≥Á≥ªÔºåÂú®ÂºπÁ™óÂºπÂá∫Êù•‰πãÂâçË¶ÅÊîπÂÆåÊï∞ÊçÆÔºåÊâÄÊúâËøôÊÆµÊîæÂâçÈù¢ÔºåÊî∂ÂõæÁâáËÇØÂÆöÊØîÊî∂Â≠óÁ¨¶‰∏≤ÊÖ¢\r\n\r\n          // this.$loading(\"loading\");//ÊòæÁ§∫Ê≠£Âú®Âä†ËΩΩ\r\n          //Êé•‰∏ãÊù•ÁöÑÈÄªËæë‰∏∫ÔºåÂèëËµ∑ËØ∑Ê±ÇÔºåÊàêÂäüÂä†ËΩΩ/Âä†ËΩΩÂ§±Ë¥•\r\n          console.log(sessionStorage.getItem(\"saToken\"));\r\n          var url = \"http://localhost:8989/fileShare/createQRCode1?fileId=\" + row.id;\r\n          this.$axios({\r\n            url:url,\r\n            method:\"GET\",\r\n            headers:{\r\n              'satoken':sessionStorage.getItem(\"saToken\")\r\n            },\r\n            responseType:\"blob\"\r\n          }).then(function (res){\r\n            console.log(\"ËØ∑Ê±ÇÂèëËµ∑ÊàêÂäü\");\r\n            console.log(res);\r\n            var typeArray = res.data;\r\n            var blob = new Blob([typeArray],{type:res.headers['Content-Type']});\r\n            var url = window.URL.createObjectURL(blob);\r\n            while(1){\r\n              console.log(\"ËøòÊú™Ëé∑Âæóurl\");\r\n              if(url!=''){\r\n                console.log(\"Ëé∑Âæóurl‰∫Ü\");\r\n                console.log(url);\r\n                that.imgUrl = url;\r\n                that.$axios({\r\n                  url:\"http://localhost:8989/getShareCode?fileId=\"+row.id,\r\n                  method:\"GET\",\r\n                  headers:{\r\n                    'satoken':sessionStorage.getItem(\"saToken\")\r\n                  },\r\n                }).then(res=>{\r\n                  console.log(res)\r\n                  var token=res.data.data[\"access_token\"]\r\n                  that.fileUrl=\"http://localhost:8989/publicDownload?access_token=\"+token\r\n                  that.dialogVisible=true\r\n                })\r\n                break;\r\n              }\r\n            }\r\n            // var imgHtmlString = \"<image src='\" + url + \"'>\";\r\n            //ÂºπÁ™ó\r\n            // that.$alert('<strong>ÊÇ®ÁöÑÂàÜ‰∫´‰∫åÁª¥Á†ÅÔºö</strong>' +\r\n            //     \"<image width='390' height='200' src='\" + url + \"'>\" +\r\n            //     '<strong>ÊÇ®ÁöÑÊñá‰ª∂‰∏ãËΩΩÂú∞ÂùÄÔºö</strong>', 'ÂàÜ‰∫´ËØ¶ÊÉÖ', {\r\n            //   dangerouslyUseHTMLString: true\r\n            // });\r\n\r\n          })\r\n          \r\n        },\r\n\r\n        // Êñá‰ª∂Â§πÊàñÊñá‰ª∂ÈáçÂëΩÂêç\r\n        handleEdit_(row) {\r\n          this.$prompt('‰øÆÊîπÊñá‰ª∂Âêç', 'ÊèêÁ§∫', {\r\n            confirmButtonText: 'Á°ÆÂÆö',\r\n            cancelButtonText: 'ÂèñÊ∂à',\r\n          }).then(({ value }) => {\r\n            if(value == null){\r\n              this.$message({\r\n                type: 'info',\r\n                message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\r\n              });\r\n              return;\r\n            }\r\n            this.axios({\r\n              method:'PUT',\r\n              url:'http://localhost:8989/rename',\r\n              data:{\r\n                folderId: row.id,\r\n                newFolderName: value\r\n              },\r\n            }).then((resp) => {\r\n              let data=resp.data;\r\n              if(data.success) {\r\n                this.getFileAndFolder()\r\n                this.$message({\r\n                  type: 'success',\r\n                  message: data.message\r\n                });\r\n              } else {\r\n                this.$message({\r\n                  type: 'info',\r\n                  message: data.message\r\n                });\r\n              }\r\n            });\r\n          }).catch(() => {\r\n            this.$message({\r\n              type: 'info',\r\n              message: 'ÂèñÊ∂àËæìÂÖ•'\r\n            });\r\n          });\r\n        },\r\n\r\n\r\n        //ÁßªÂä®Êñá‰ª∂Â§πÊàñÊñá‰ª∂\r\n        moveFile(row) {\r\n            console.log(row);\r\n            this.$prompt('ËæìÂÖ•Ë¶ÅÁßªÂä®ÁöÑË∑ØÂæÑÔºåÊ†ºÂºè: /**/**/', 'ÁßªÂä®Âà∞', {\r\n              confirmButtonText: 'Á°ÆÂÆö',\r\n              cancelButtonText: 'ÂèñÊ∂à',\r\n            }).then(({ value }) => {\r\n              if(value == null){\r\n                this.$message({\r\n                  type: 'info',\r\n                  message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\r\n                });\r\n                return;\r\n              }\r\n              if(this.pathString == value){\r\n                this.$message({\r\n                  type: 'info',\r\n                  message: \"Â∑≤Âú®ÂΩìÂâçÊñá‰ª∂Â§π\"\r\n                });\r\n                return;\r\n              }\r\n              this.axios({\r\n                method:'PUT',\r\n                url:'http://localhost:8989/move',\r\n                data:{\r\n                  folderId: row.id,\r\n                  newPath: value\r\n                },\r\n              }).then((resp) => {\r\n                let data=resp.data;\r\n                if(data.success) {\r\n                  this.getFileAndFolder()\r\n                  this.$message({\r\n                    type: 'success',\r\n                    message: data.message\r\n                  });\r\n                } else {\r\n                  this.$message({\r\n                    type: 'info',\r\n                    message: data.message\r\n                  });\r\n                }\r\n              });\r\n            }).catch(() => {\r\n              this.$message({\r\n                type: 'info',\r\n                message: 'ÂèñÊ∂àËæìÂÖ•'\r\n              });\r\n            });\r\n        },\r\n\r\n        updateFolderSize() {\r\n          this.axios({\r\n            method:'GET',\r\n            url:'http://localhost:8989/getFolderSize?path='+this.pathString,\r\n          })\r\n        },\r\n\r\n        // Ëé∑ÂèñË∑ØÂæÑ‰∏ãÊñá‰ª∂ÂíåÊñá‰ª∂Â§π\r\n        getFileAndFolder() {\r\n          var url = 'http://localhost:8989/getFilesAndFolders?path=' + this.pathString;\r\n          this.axios({\r\n            method:'GET',\r\n            url: url,\r\n          }).then((resp)=>{\r\n            let data = resp.data;\r\n            console.log(data)\r\n            if (data.success) {\r\n              this.tableData = data.data.fileList;\r\n            }\r\n          })\r\n        },\r\n\r\n        // ÂàõÂª∫Êñá‰ª∂Â§π\r\n        createDir() {\r\n          this.$prompt('ËæìÂÖ•Êñá‰ª∂Â§πÁõÆÂΩï', 'ÊèêÁ§∫', {\r\n            confirmButtonText: 'Á°ÆÂÆö',\r\n            cancelButtonText: 'ÂèñÊ∂à',\r\n          }).then(({ value }) => {\r\n            if(value == null){\r\n              this.$message({\r\n                type: 'info',\r\n                message: \"ËæìÂÖ•‰∏çËÉΩ‰∏∫Á©∫\"\r\n              });\r\n              return;\r\n            }\r\n            this.axios({\r\n              method:'POST',\r\n              url:'http://localhost:8989/createFolder',\r\n              data:{\r\n                path: this.pathString,\r\n                folderName: value\r\n              }\r\n            }).then((resp) => {\r\n              let data=resp.data;\r\n              if(data.success) {\r\n                this.getFileAndFolder()\r\n                this.$message({\r\n                  type: 'success',\r\n                  message: data.message\r\n                });\r\n              } else {\r\n                this.$message({\r\n                  type: 'info',\r\n                  message: data.message\r\n                });\r\n              }\r\n            });\r\n          }).catch(() => {\r\n            this.$message({\r\n              type: 'info',\r\n              message: 'ÂèñÊ∂àËæìÂÖ•'\r\n            });\r\n          });\r\n        },\r\n\r\n        // Âà†Èô§Êñá‰ª∂Â§πÊàñÊñá‰ª∂\r\n        deleteFile_(row, index) {\r\n          if(confirm(\"ÊòØÂê¶Âà†Èô§ÔºÅ\")) {\r\n            this.axios({\r\n              method:'DELETE',\r\n              url:'http://localhost:8989/delete',\r\n              data:{\r\n                fileId: row.id\r\n              }\r\n            }).then((resp) => {\r\n              let data=resp.data;\r\n              if(data.success) {\r\n                this.tableData.splice(index,1)\r\n                this.$message({\r\n                  type: 'success',\r\n                  message: data.message\r\n                });\r\n              } else {\r\n                this.$message({\r\n                  type: 'info',\r\n                  message: data.message\r\n                });\r\n              }\r\n            });\r\n          }else {\r\n            this.$message({\r\n              type: 'info',\r\n              message: 'ÂèñÊ∂àÂà†Èô§'\r\n            });\r\n          }\r\n        },\r\n\r\n\r\n        getFile(event) {\r\n          this.file=event.target.files[0];\r\n          console.log(this.file);\r\n        },\r\n\r\n        submitForm(event) {\r\n          event.preventDefault();\r\n          let formData=new FormData();\r\n          formData.append('ifile', this.file);\r\n          formData.append(\"path\", this.pathString)\r\n\r\n          let config={\r\n            headers:{\r\n              'Content-Type': 'multipart/form-data',\r\n              \"satoken\": sessionStorage.getItem(\"satoken\")\r\n            },\r\n            // üëá ÂÖ≥ÈîÆÔºöÁõëÂê¨‰∏ä‰º†ËøõÂ∫¶\r\n            onUploadProgress: (progressEvent) => {\r\n              if (progressEvent.total > 0) {\r\n                this.uploadProgress = Math.round((progressEvent.loaded / progressEvent.total) * 100);\r\n              }\r\n            }\r\n          }\r\n          console.log(config)\r\n          var url=\"http://localhost:8989/upload\"\r\n          this.$http.post(url, formData, config).then(res=>{\r\n            console.log(res)\r\n            let data=res.data\r\n            if(data.code!==10000){\r\n              this.$message.error(data.message)\r\n            } else {\r\n              this.getFileAndFolder()\r\n              this.$message({\r\n                message: \"‰∏ä‰º†ÊàêÂäü\",\r\n                type: \"success\"\r\n              })\r\n            }\r\n          })\r\n        },\r\n\r\n        download(row) {\r\n          let that=this\r\n          console.log(row)\r\n          let headers={\r\n            'Content-Type': 'multipart/form-data',\r\n            \"satoken\": sessionStorage.getItem(\"satoken\")\r\n          }\r\n          var fileId=row.id\r\n          var filename=row.fileName\r\n          // let url=\"http://localhost:8989/download?fileId=\"+fileId\r\n          // window.open(url, \"_blank\")\r\n          this.axios({\r\n            url: \"http://localhost:8989/download\",\r\n            method: \"GET\",\r\n            headers: headers,\r\n            params: {\r\n              fileId: fileId\r\n            },\r\n          }).then(res=>{\r\n            console.log(res)\r\n            that.$message({\r\n              message: \"ËØ∑Ê±ÇÊàêÂäü\",\r\n              type: \"success\"\r\n            })\r\n            let blob = new Blob([res.data]);\r\n            let downloadElement = document.createElement(\"a\");\r\n            let href = window.URL.createObjectURL(blob); //ÂàõÂª∫‰∏ãËΩΩÁöÑÈìæÊé•\r\n            downloadElement.href = href;\r\n            downloadElement.download = filename; //‰∏ãËΩΩÂêéÊñá‰ª∂Âêç\r\n            document.body.appendChild(downloadElement);\r\n            downloadElement.click(); //ÁÇπÂáª‰∏ãËΩΩ\r\n            document.body.removeChild(downloadElement); //‰∏ãËΩΩÂÆåÊàêÁßªÈô§ÂÖÉÁ¥†\r\n            window.URL.revokeObjectURL(href); //ÈáäÊîæÊéâblobÂØπË±°\r\n          }).catch(function(error){\r\n            if (error.response.status==400){\r\n              that.$message({\r\n                message: \"Êñá‰ª∂‰∏çÂ≠òÂú®\",\r\n                type: \"error\"\r\n              })\r\n            }\r\n            else if (error.response.status==500){\r\n              that.$message({\r\n                message: \"Êä±Ê≠âÔºåÊñá‰ª∂Â∑≤‰∏¢Â§±\",\r\n                type: \"error\"\r\n              })\r\n            }\r\n          })\r\n\r\n        }\r\n      },\r\n      \r\n      get methods() {\r\n        return this._methods;\r\n      },\r\n      set methods(value) {\r\n        this._methods=value;\r\n      },\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.mydisk{\r\n    margin-left: 0px;\r\n}\r\n.header {\r\n  display: flex;\r\n  align-items: center; // ÂûÇÁõ¥Â±Ö‰∏≠\r\n  margin-top: 10px;\r\n  margin-left: 20px;\r\n  flex-wrap: wrap; // Èò≤Ê≠¢Â∞èÂ±èÊ∫¢Âá∫\r\n}\r\n\r\n.bread{\r\n  display: flex;\r\n  margin-left: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.wrapper{\r\n    margin: 10px 20px;\r\n}\r\n\r\n.input1_ {\r\n    width: 150px;\r\n}\r\n.btn1_ {\r\n    background-color: #409EFF;\r\n    border: 0px;\r\n    height: 30px;\r\n    border-radius: 8px;\r\n    color: white;\r\n    width: 50px;\r\n}\r\n\r\n.dialogImg{\r\n  width: 80%;\r\n  //margin-left: 5%;\r\n  height: 60%;\r\n  margin-bottom: 5%;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}