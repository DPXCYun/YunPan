{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'Register',\n  data() {\n    var validatePass = (rule, value, callback) => {\n      //检查密码是否合法\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (this.ruleForm.checkPass !== '') {\n          this.$refs.ruleForm.validateField('checkPass');\n        }\n        callback();\n      }\n    };\n    var validatePass2 = (rule, value, callback) => {\n      //检查重复密码是否合法\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== this.ruleForm.password) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      ruleForm: {\n        email: '',\n        password: '',\n        username: '',\n        checkPass: \"\",\n        emailCode: \"\",\n        //邮箱验证码\n        phoneNumber: ''\n      },\n      rules: {\n        password: [{\n          validator: validatePass,\n          trigger: 'blur'\n        }],\n        checkPass: [{\n          validator: validatePass2,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    //发送邮件\n    sendEmail() {\n      //判断用户是否输入邮箱\n      if (this.ruleForm.email == \"\") {\n        this.$message({\n          message: '未输入邮箱',\n          type: 'error'\n        });\n        return;\n      }\n      //调用发送邮件的接口\n      var that = this;\n      this.$axios({\n        method: 'GET',\n        url: \"http://localhost:8989/regist/sendEmail\",\n        params: {\n          email: this.ruleForm.email\n        },\n        timeout: 15000\n      }).then(function (response) {\n        console.log(response);\n        console.log(response.data);\n        console.log(response.data.data);\n        if (response.data.message === \"邮箱格式错误或已被注册\") {\n          that.$message({\n            message: '邮箱已经被注册',\n            type: 'error'\n          });\n          return;\n        }\n        if (response.data.message === \"发送成功！\") {\n          that.$message({\n            message: '发送成功！',\n            type: 'success'\n          });\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    //注册按钮\n    submitForm(ruleForm) {\n      //检查用户名，密码等是否已经输入完成\n      if (this.ruleForm.email === \"\" || this.ruleForm.username === \"\" || this.ruleForm.password === \"\" || this.ruleForm.checkPass === \"\" || this.ruleForm.phoneNumber === \"\" || this.ruleForm.emailCode === \"\") {\n        this.$message({\n          message: '信息填写不完整',\n          type: 'error'\n        });\n        return;\n      }\n      //此时表单内容已经输入完全\n      var that = this;\n      this.$axios({\n        method: 'POST',\n        url: 'http://localhost:8989/regist/byemail',\n        data: {\n          email: this.ruleForm.email,\n          code: this.ruleForm.emailCode,\n          username: this.ruleForm.username,\n          password: this.ruleForm.password,\n          phone: this.ruleForm.phoneNumber\n        }\n      }).then(function (response) {\n        console.log(response);\n        console.log(response.data);\n        if (response.data.message === \"手机号已被注册\") {\n          that.$message({\n            message: '手机号已被注册',\n            type: 'error'\n          });\n          return;\n        }\n        if (response.data.message === \"验证码错误或已失效\") {\n          that.$message({\n            message: '验证码错误或已失效',\n            type: 'error'\n          });\n          return;\n        }\n        if (response.data.message === \"注册成功！\") {\n          that.$message({\n            message: '注册成功！',\n            type: 'success'\n          });\n          this.$router.push({\n            path: '/'\n          });\n        }\n      }).catch(function (error) {\n        // console.log(error);\n        that.$message({\n          message: '服务器错误，请稍后重试！',\n          type: 'error'\n        });\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    toLogin() {\n      this.$router.push({\n        path: '/'\n      });\n    }\n  }\n};","map":{"version":3,"mappings":";AAwCA;EACAA;EACAC;IACA;MAAA;MACA;QACAC;MACA;QACA;UACA;QACA;QACAA;MACA;IACA;IACA;MAAA;MACA;QACAA;MACA;QACAA;MACA;QACAA;MACA;IACA;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;MACA;MACAC;QACAL,WACA;UAAAM;UAAAC;QAAA,EACA;QACAL,YACA;UAAAI;UAAAC;QAAA;MAEA;IACA;EACA;EACAC;IACA;IACAC;MACA;MACA;QACA;UACAC;UACAC;QACA;QACA;MACA;MACA;MACA;MACA;QACAC;QACAC;QACAC;UACAf;QACA;QACAgB;MACA,GACAC;QACAC;QACAA;QACAA;QACA;UACAC;YACAR;YACAC;UACA;UACA;QACA;QACA;UACAO;YACAR;YACAC;UACA;QACA;MACA,GACAQ;QACAF;MACA;IACA;IACA;IACAG;MACA;MACA,mEACA,mEACA;QACA;UACAV;UACAC;QACA;QACA;MACA;MACA;MACA;MACA;QACAC;QACAC;QACAjB;UACAG;UACAsB;UACApB;UACAD;UACAsB;QACA;MACA;QACAL;QACAA;QACA;UACAC;YACAR;YACAC;UACA;UACA;QACA;QACA;UACAO;YACAR;YACAC;UACA;UACA;QACA;QACA;UACAO;YACAR;YACAC;UACA;UACA;YAAAY;UAAA;QACA;MACA,GACAJ;QACA;QACAD;UACAR;UACAC;QACA;MACA;IACA;IACAa;MACA;IACA;IAEAC;MACA;QAAAF;MAAA;IACA;EACA;AACA","names":["name","data","callback","ruleForm","email","password","username","checkPass","emailCode","phoneNumber","rules","validator","trigger","methods","sendEmail","message","type","method","url","params","timeout","then","console","that","catch","submitForm","code","phone","path","resetForm","toLogin"],"sourceRoot":"src/views","sources":["Register.vue"],"sourcesContent":["<template>\r\n    <div id=\"poster\">\r\n        <el-form :model=\"ruleForm\"  label-position=\"left\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"0px\" class=\"register-container\">\r\n            <h3 class=\"register_title\" style=\"color:green\">\r\n            <i class=\"el-icon-service\"></i>\r\n            注册用户\r\n            </h3>\r\n\r\n        <el-form-item label=\"\" prop=\"loginName\">\r\n           <el-input type=\"text\" v-model=\"ruleForm.email\" placeholder=\"邮箱（将收到验证码）\" prefix-icon=\"el-icon-message\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"\" prop=\"name\">\r\n           <el-input type=\"text\" v-model=\"ruleForm.username\" prefix-icon=\"el-icon-user-solid\" placeholder=\"用户名\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"\" prop=\"password\">\r\n           <el-input type=\"password\" v-model=\"ruleForm.password\" autocomplete=\"off\" placeholder=\"密码\" prefix-icon=\"el-icon-lock\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"\" prop=\"checkPass\">\r\n           <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\" placeholder=\"重复密码\"></el-input>\r\n        </el-form-item>\r\n          <el-form-item label=\"\" prop=\"emailCode\">\r\n            <el-input type=\"text\" v-model=\"ruleForm.emailCode\" placeholder=\"邮箱验证码\" prefix-icon=\"el-icon-message\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"\" prop=\"phoneNumber\">\r\n            <el-input type=\"text\" v-model=\"ruleForm.phoneNumber\" placeholder=\"手机号\" prefix-icon=\"el-icon-message\"></el-input>\r\n          </el-form-item>\r\n\r\n        <el-form-item>\r\n        <el-button  style=\"background:yellowgreen;border:none\" @click=\"sendEmail()\" icon=\"el-icon-refresh\" class=\"button1\">发送验证码</el-button>\r\n        <el-button type=\"primary\" style=\"background:green;border:none;color:white\" @click=\"submitForm('ruleForm')\" icon=\"el-icon-right\" class=\"button2\">注册</el-button>\r\n        </el-form-item>\r\n        <el-form-item style=\"width:100%;\">\r\n            <el-button type=\"primary\" style=\"width:100%;background:green;border:none;color:yellow\" v-on:click=\"toLogin()\" icon=\"el-icon-back\">回到登录</el-button>\r\n        </el-form-item>\r\n    </el-form>\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  \r\n  export default {\r\n    name: 'Register',\r\n    data() {\r\n      var validatePass = (rule, value, callback) => {//检查密码是否合法\r\n        if (value === '') {\r\n          callback(new Error('请输入密码'));\r\n        } else {\r\n          if (this.ruleForm.checkPass !== '') {\r\n            this.$refs.ruleForm.validateField('checkPass');\r\n          }\r\n          callback();\r\n        }\r\n      };\r\n      var validatePass2 = (rule, value, callback) => {//检查重复密码是否合法\r\n        if (value === '') {\r\n          callback(new Error('请再次输入密码'));\r\n        } else if (value !== this.ruleForm.password) {\r\n          callback(new Error('两次输入密码不一致!'));\r\n        } else {\r\n          callback();\r\n        }\r\n      };\r\n      return {\r\n        ruleForm: {\r\n          email: '',\r\n          password: '',\r\n          username: '',\r\n          checkPass:\"\",\r\n          emailCode:\"\",//邮箱验证码\r\n          phoneNumber:''\r\n        },\r\n        rules: {\r\n          password: [\r\n            { validator: validatePass, trigger: 'blur' }\r\n          ],\r\n          checkPass: [\r\n            { validator: validatePass2, trigger: 'blur' }\r\n          ],\r\n        }\r\n      };\r\n    },\r\n    methods: {\r\n      //发送邮件\r\n      sendEmail(){\r\n        //判断用户是否输入邮箱\r\n        if(this.ruleForm.email==\"\"){\r\n          this.$message({\r\n            message: '未输入邮箱',\r\n            type: 'error'\r\n          });\r\n          return;\r\n        }\r\n        //调用发送邮件的接口\r\n        var that = this;\r\n        this.$axios({\r\n          method:'GET',\r\n          url:\"http://localhost:8989/regist/sendEmail\",\r\n          params:{\r\n            email:this.ruleForm.email\r\n          },\r\n          timeout:15000\r\n        })\r\n            .then(function (response){\r\n              console.log(response);\r\n              console.log(response.data);\r\n              console.log(response.data.data);\r\n              if(response.data.message===\"邮箱格式错误或已被注册\"){\r\n                that.$message({\r\n                  message: '邮箱已经被注册',\r\n                  type: 'error'\r\n                });\r\n                return;\r\n              }\r\n              if(response.data.message===\"发送成功！\"){\r\n                that.$message({\r\n                  message: '发送成功！',\r\n                  type: 'success'\r\n                });\r\n              }\r\n            })\r\n            .catch(function (error){\r\n              console.log(error)\r\n            })\r\n      },\r\n      //注册按钮\r\n      submitForm(ruleForm) {\r\n        //检查用户名，密码等是否已经输入完成\r\n        if(this.ruleForm.email===\"\"||this.ruleForm.username===\"\"\r\n            ||this.ruleForm.password===\"\"||this.ruleForm.checkPass===\"\"\r\n            ||this.ruleForm.phoneNumber===\"\"||this.ruleForm.emailCode===\"\"){\r\n          this.$message({\r\n            message: '信息填写不完整',\r\n            type: 'error'\r\n          });\r\n          return;\r\n        }\r\n        //此时表单内容已经输入完全\r\n        var that = this;\r\n        this.$axios({\r\n          method:'POST',\r\n          url:'http://localhost:8989/regist/byemail',\r\n          data:{\r\n            email:this.ruleForm.email,\r\n            code:this.ruleForm.emailCode,\r\n            username:this.ruleForm.username,\r\n            password:this.ruleForm.password,\r\n            phone:this.ruleForm.phoneNumber\r\n          }\r\n        }).then(function (response){\r\n          console.log(response);\r\n          console.log(response.data);\r\n          if(response.data.message===\"手机号已被注册\"){\r\n            that.$message({\r\n              message: '手机号已被注册',\r\n              type: 'error'\r\n            });\r\n            return;\r\n          }\r\n          if(response.data.message===\"验证码错误或已失效\"){\r\n            that.$message({\r\n              message: '验证码错误或已失效',\r\n              type: 'error'\r\n            });\r\n            return;\r\n          }\r\n          if(response.data.message===\"注册成功！\"){\r\n            that.$message({\r\n              message: '注册成功！',\r\n              type: 'success'\r\n            });\r\n            this.$router.push({path:'/'})\r\n          }\r\n        })\r\n            .catch(function (error){\r\n              // console.log(error);\r\n              that.$message({\r\n                message: '服务器错误，请稍后重试！',\r\n                type: 'error'\r\n              });\r\n            })\r\n      },\r\n      resetForm(formName) {\r\n        this.$refs[formName].resetFields();\r\n      },\r\n\r\n      toLogin(){\r\n        this.$router.push({path:'/'})\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  <style>\r\n    #poster{\r\n        background-position: center;\r\n        height: 100%;\r\n        width: 100%;\r\n        background-size: cover;\r\n        position: fixed;\r\n        margin: 0px;\r\n        padding: 0px;\r\n    }\r\n\r\n    .register-container{\r\n        border-radius: 15px;\r\n        background-clip: padding-box;\r\n        margin: 90px auto;\r\n        width: 350px;\r\n        padding: 35px 35px 15px 35px;\r\n        background: #fff;\r\n        border: 1px solid #eaeaea;\r\n        box-shadow: 0 0 25px #cac6c6;\r\n    }\r\n\r\n    .register_title{\r\n        margin: 0px auto 40px auto;\r\n        text-align: center;\r\n        color: #505458;\r\n    }\r\n\r\n    .button1{\r\n        float:left ;\r\n    }\r\n    .button2{\r\n        float: right;\r\n        width: 200px;\r\n    }\r\n  </style>\r\n  "]},"metadata":{},"sourceType":"module"}